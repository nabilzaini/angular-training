{"ast":null,"code":"import * as i0 from \"@angular/core\";\nimport * as i1 from \"../services/product.service\";\nimport * as i2 from \"@angular/router\";\nimport * as i3 from \"../services/appstate.service\";\nimport * as i4 from \"@angular/common\";\nimport * as i5 from \"@angular/forms\";\nfunction ProductsComponent_tr_17_Template(rf, ctx) {\n  if (rf & 1) {\n    const _r4 = i0.ɵɵgetCurrentView();\n    i0.ɵɵelementStart(0, \"tr\")(1, \"td\");\n    i0.ɵɵtext(2);\n    i0.ɵɵelementEnd();\n    i0.ɵɵelementStart(3, \"td\");\n    i0.ɵɵtext(4);\n    i0.ɵɵelementEnd();\n    i0.ɵɵelementStart(5, \"td\")(6, \"button\", 11);\n    i0.ɵɵlistener(\"click\", function ProductsComponent_tr_17_Template_button_click_6_listener() {\n      const restoredCtx = i0.ɵɵrestoreView(_r4);\n      const product_r2 = restoredCtx.$implicit;\n      const ctx_r3 = i0.ɵɵnextContext();\n      return i0.ɵɵresetView(ctx_r3.handleCheckProduct(product_r2));\n    });\n    i0.ɵɵelement(7, \"i\");\n    i0.ɵɵelementEnd()();\n    i0.ɵɵelementStart(8, \"td\")(9, \"button\", 12);\n    i0.ɵɵlistener(\"click\", function ProductsComponent_tr_17_Template_button_click_9_listener() {\n      const restoredCtx = i0.ɵɵrestoreView(_r4);\n      const product_r2 = restoredCtx.$implicit;\n      const ctx_r5 = i0.ɵɵnextContext();\n      return i0.ɵɵresetView(ctx_r5.deleteProduct(product_r2));\n    });\n    i0.ɵɵelement(10, \"i\", 13);\n    i0.ɵɵelementEnd()();\n    i0.ɵɵelementStart(11, \"td\")(12, \"button\", 14);\n    i0.ɵɵlistener(\"click\", function ProductsComponent_tr_17_Template_button_click_12_listener() {\n      const restoredCtx = i0.ɵɵrestoreView(_r4);\n      const product_r2 = restoredCtx.$implicit;\n      const ctx_r6 = i0.ɵɵnextContext();\n      return i0.ɵɵresetView(ctx_r6.editProduct(product_r2));\n    });\n    i0.ɵɵelement(13, \"i\", 15);\n    i0.ɵɵelementEnd()()();\n  }\n  if (rf & 2) {\n    const product_r2 = ctx.$implicit;\n    i0.ɵɵadvance(2);\n    i0.ɵɵtextInterpolate(product_r2.name);\n    i0.ɵɵadvance(2);\n    i0.ɵɵtextInterpolate(product_r2.price);\n    i0.ɵɵadvance(3);\n    i0.ɵɵclassMap(product_r2.checked ? \"bi bi-check\" : \"bi bi-circle\");\n  }\n}\nfunction ProductsComponent_button_19_Template(rf, ctx) {\n  if (rf & 1) {\n    const _r10 = i0.ɵɵgetCurrentView();\n    i0.ɵɵelementStart(0, \"button\", 16);\n    i0.ɵɵlistener(\"click\", function ProductsComponent_button_19_Template_button_click_0_listener() {\n      const restoredCtx = i0.ɵɵrestoreView(_r10);\n      const i_r8 = restoredCtx.index;\n      const ctx_r9 = i0.ɵɵnextContext();\n      return i0.ɵɵresetView(ctx_r9.handlePage(i_r8 + 1));\n    });\n    i0.ɵɵtext(1);\n    i0.ɵɵelementEnd();\n  }\n  if (rf & 2) {\n    const i_r8 = ctx.index;\n    const ctx_r1 = i0.ɵɵnextContext();\n    i0.ɵɵproperty(\"ngClass\", ctx_r1.currentPage == i_r8 + 1 ? \"btn btn-success m-1\" : \"btn btn-outline-success m-1\");\n    i0.ɵɵadvance(1);\n    i0.ɵɵtextInterpolate1(\" \", i_r8 + 1, \" \");\n  }\n}\nconst _c0 = function () {\n  return [];\n};\nexport class ProductsComponent {\n  //$ à la fin de la variable pour indiquer un observable\n  //! pour ignorer l'initialisation de la variable\n  /*public products: Array<Product> = [];\n  public keyword:string = '';\n  currentPage:number = 1;\n  pageSize:number = 3;\n  totalPages:number = 0;*/\n  constructor(productService, router, appStateService) {\n    this.productService = productService;\n    this.router = router;\n    this.appStateService = appStateService;\n  }\n  ngOnInit() {\n    this.getProducts();\n  }\n  getProducts() {\n    this.productService.getProducts(this.appStateService.keyword, this.appStateService.currentPage, this.appStateService.pageSize).subscribe({\n      next: response => {\n        this.appStateService.products = response.body;\n        let totalElements = parseInt(response.headers.get(\"x-total-count\"));\n        this.appStateService.totalPages = Math.floor(totalElements / this.appStateService.pageSize);\n        if (totalElements % this.appStateService.pageSize != 0) {\n          this.appStateService.totalPages = this.appStateService.totalPages + 1;\n        }\n      },\n      error: err => {\n        console.log(\"Erreur\");\n      }\n    });\n  }\n  handlePage(indexPage) {\n    this.appStateService.currentPage = indexPage;\n    this.getProducts();\n  }\n  handleCheckProduct(product) {\n    this.productService.checkedProduct(product).subscribe({\n      next: updatedProduct => {\n        product.checked = !product.checked;\n      }\n    });\n  }\n  deleteProduct(product) {\n    if (confirm(\"Etes vous sûre ?\")) this.productService.deleteProduct(product).subscribe({\n      next: data => {\n        this.products = this.products.filter(p => p.id != product.id);\n      }\n    });\n  }\n  editProduct(product) {\n    this.router.navigateByUrl(`/editProduct/${product.id}`);\n  }\n  static #_ = this.ɵfac = function ProductsComponent_Factory(t) {\n    return new (t || ProductsComponent)(i0.ɵɵdirectiveInject(i1.ProductService), i0.ɵɵdirectiveInject(i2.Router), i0.ɵɵdirectiveInject(i3.AppstateService));\n  };\n  static #_2 = this.ɵcmp = /*@__PURE__*/i0.ɵɵdefineComponent({\n    type: ProductsComponent,\n    selectors: [[\"app-products\"]],\n    decls: 20,\n    vars: 4,\n    consts: [[1, \"p-3\"], [1, \"card\"], [1, \"card-body\"], [\"type\", \"text\", 3, \"ngModel\", \"ngModelChange\"], [1, \"btn\", \"btn-success\", \"ms-1\", 3, \"click\"], [1, \"bi\", \"bi-search\"], [1, \"table\"], [\"scope\", \"col\"], [4, \"ngFor\", \"ngForOf\"], [1, \"nav\", \"nav-pills\"], [3, \"ngClass\", \"click\", 4, \"ngFor\", \"ngForOf\"], [1, \"btn\", \"btn-outline-success\", 3, \"click\"], [1, \"btn\", \"btn-outline-danger\", 3, \"click\"], [1, \"bi\", \"bi-trash\"], [1, \"btn\", \"btn-outline-warning\", 3, \"click\"], [1, \"bi\", \"bi-pencil\"], [3, \"ngClass\", \"click\"]],\n    template: function ProductsComponent_Template(rf, ctx) {\n      if (rf & 1) {\n        i0.ɵɵelementStart(0, \"div\", 0)(1, \"div\", 1)(2, \"div\", 2)(3, \"div\", 2)(4, \"input\", 3);\n        i0.ɵɵlistener(\"ngModelChange\", function ProductsComponent_Template_input_ngModelChange_4_listener($event) {\n          return ctx.keyword = $event;\n        });\n        i0.ɵɵelementEnd();\n        i0.ɵɵelementStart(5, \"button\", 4);\n        i0.ɵɵlistener(\"click\", function ProductsComponent_Template_button_click_5_listener() {\n          return ctx.getProducts();\n        });\n        i0.ɵɵelement(6, \"i\", 5);\n        i0.ɵɵelementEnd()();\n        i0.ɵɵelementStart(7, \"table\", 6)(8, \"thead\")(9, \"tr\")(10, \"th\", 7);\n        i0.ɵɵtext(11, \"Name\");\n        i0.ɵɵelementEnd();\n        i0.ɵɵelementStart(12, \"th\", 7);\n        i0.ɵɵtext(13, \"Price\");\n        i0.ɵɵelementEnd();\n        i0.ɵɵelementStart(14, \"th\", 7);\n        i0.ɵɵtext(15, \"Checked\");\n        i0.ɵɵelementEnd()()();\n        i0.ɵɵelementStart(16, \"tbody\");\n        i0.ɵɵtemplate(17, ProductsComponent_tr_17_Template, 14, 4, \"tr\", 8);\n        i0.ɵɵelementEnd()();\n        i0.ɵɵelementStart(18, \"div\", 9);\n        i0.ɵɵtemplate(19, ProductsComponent_button_19_Template, 2, 2, \"button\", 10);\n        i0.ɵɵelementEnd()()()();\n      }\n      if (rf & 2) {\n        i0.ɵɵadvance(4);\n        i0.ɵɵproperty(\"ngModel\", ctx.keyword);\n        i0.ɵɵadvance(13);\n        i0.ɵɵproperty(\"ngForOf\", ctx.products);\n        i0.ɵɵadvance(2);\n        i0.ɵɵproperty(\"ngForOf\", i0.ɵɵpureFunction0(3, _c0).constructor(ctx.totalPages));\n      }\n    },\n    dependencies: [i4.NgClass, i4.NgForOf, i5.DefaultValueAccessor, i5.NgControlStatus, i5.NgModel],\n    styles: [\"\\n/*# sourceMappingURL=data:application/json;charset=utf-8;base64,eyJ2ZXJzaW9uIjozLCJzb3VyY2VzIjpbXSwibmFtZXMiOltdLCJtYXBwaW5ncyI6IiIsInNvdXJjZVJvb3QiOiIifQ== */\"]\n  });\n}","map":{"version":3,"mappings":"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","names":["i0","ProductsComponent","constructor","productService","router","appStateService","ngOnInit","getProducts","keyword","currentPage","pageSize","subscribe","next","response","products","body","totalElements","parseInt","headers","get","totalPages","Math","floor","error","err","console","log","handlePage","indexPage","handleCheckProduct","product","checkedProduct","updatedProduct","checked","deleteProduct","confirm","data","filter","p","id","editProduct","navigateByUrl","selectors","decls","vars","consts","template","ctx"],"sourceRoot":"","sources":["/home/zaini/Documents/Nabil/workspace-entrainement/angular/angular-training/src/app/products/products.component.html","/home/zaini/Documents/Nabil/workspace-entrainement/angular/angular-training/src/app/products/products.component.ts"],"sourcesContent":["<div class=\"p-3\">\n    <div class=\"card\">\n        <div class=\"card-body\">\n            <div class=\"card-body\">\n                <input type=\"text\" [(ngModel)]=\"keyword\">\n                <button class=\"btn btn-success ms-1\" (click)=\"getProducts()\" >\n                    <i class=\"bi bi-search\"></i>\n                </button>\n            </div>\n            <table class=\"table\">\n                <thead>\n                    <tr>\n                        <th scope=\"col\">Name</th>\n                        <th scope=\"col\">Price</th>\n                        <th scope=\"col\">Checked</th>\n                    </tr>    \n                </thead>\n                <tbody>\n                    <tr *ngFor=\"let product of products\">\n                        <td>{{product.name}}</td>\n                        <td>{{product.price}}</td>\n                        <td>\n                            <button (click)=\"handleCheckProduct(product)\" class=\"btn btn-outline-success\">\n                                <i [class]=\"product.checked ?\n                                 'bi bi-check' :\n                                  'bi bi-circle'\"></i>\n                            </button>\n                        </td>\n                        <td>\n                            <button (click)=\"deleteProduct(product)\" class=\"btn btn-outline-danger\">\n                                <i class=\"bi bi-trash\"></i>    \n                            </button>\n                        </td>\n                        <td>\n                            <button (click)=\"editProduct(product)\" class=\"btn btn-outline-warning\">\n                                <i class=\"bi bi-pencil\"></i>    \n                            </button>\n                        </td>\n                    </tr>\n                </tbody>\n            </table>\n\n            <div class=\"nav nav-pills\">\n              <button \n              *ngFor=\"let page of [].constructor(totalPages); let i = index\"\n              [ngClass]=\"currentPage==(i+1) ? 'btn btn-success m-1' : 'btn btn-outline-success m-1'\"\n              (click)=\"handlePage(i+1)\">\n                {{(i+1)}}\n              </button>      \n            </div>\n        </div>\n    </div>\n</div>\n","import { Component, OnInit } from '@angular/core';\nimport { Router } from '@angular/router';\nimport { Observable } from 'rxjs';\nimport { Product } from '../model/product.model';\nimport { AppstateService } from '../services/appstate.service';\nimport { ProductService } from '../services/product.service';\n\n@Component({\n  selector: 'app-products',\n  templateUrl: './products.component.html',\n  styleUrls: ['./products.component.css']\n})\nexport class ProductsComponent implements OnInit{\n\n\n  //$ à la fin de la variable pour indiquer un observable\n  //! pour ignorer l'initialisation de la variable\n  /*public products: Array<Product> = [];\n  public keyword:string = '';\n  currentPage:number = 1;\n  pageSize:number = 3;\n  totalPages:number = 0;*/\n\n\n  constructor(private productService: ProductService, private router:Router, private appStateService: AppstateService){}\n\n  ngOnInit(){\n    this.getProducts();\n  }\n\n  getProducts(){\n    this.productService.getProducts(this.appStateService.keyword, this.appStateService.currentPage, this.appStateService.pageSize)\n    .subscribe({\n      next: response => {\n          this.appStateService.products  = response.body as Product[];\n          let totalElements:number = parseInt(response.headers.get(\"x-total-count\")!);\n          this.appStateService.totalPages = Math.floor(totalElements/this.appStateService.pageSize);\n\n          if(totalElements % this.appStateService.pageSize != 0){\n            this.appStateService.totalPages = this.appStateService.totalPages + 1;\n          }\n      },\n      error: err => {\n        console.log(\"Erreur\");\n      }\n    });\n  }\n\n  handlePage(indexPage: number) {\n    this.appStateService.currentPage = indexPage;\n    this.getProducts();\n  }\n\n    \n  handleCheckProduct(product: Product){\n    this.productService.checkedProduct(product)\n    .subscribe({\n      next: updatedProduct => {\n        product.checked = !product.checked\n        }\n      }\n    )\n  }\n\n  deleteProduct(product: Product){\n    if(confirm(\"Etes vous sûre ?\"))\n    this.productService.deleteProduct(product)\n    .subscribe({\n      next: data => {\n        this.products = this.products.filter(p => p.id != product.id)\n      }\n    });\n  }\n\n  editProduct(product: Product) {\n    this.router.navigateByUrl(`/editProduct/${product.id}`);\n  }\n}\n"]},"metadata":{},"sourceType":"module","externalDependencies":[]}